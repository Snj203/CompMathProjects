

N = 0
W = 0
CUR_FPART = -1
FPART = FPART * 2
DO WHILE(N < 24 )
  IF(FPART > UL .OR. FPART == UL)THEN
    FPART = FPART - UL
    INTEGER_PART(N) = 1
  ELSE
    INTEGER_PART(N) = 0
  END IF
  FRACTIONAL_PART(W) = FPART
  FPART = FPART * 2
  W = W + 1
  N = N + 1 
  IF(ANY(FRACTIONAL_PART == FPART))THEN
    EXIT
  END IF
END DO 
NN = N